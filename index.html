<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cr√©ateur de souvenirs romantiques pour la Saint-Valentin">
    <title>Cr√©ateur de Souvenirs - Saint-Valentin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ù§Ô∏è</text></svg>">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #ffafbd, #ffc3a0);
            color: #5a3d5c;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #d63384;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #9d4edd;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
        }
        
        .step {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ffc3a0;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .step.active {
            background: #ff4d8d;
        }
        
        .step.completed {
            background: #d63384;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #d63384;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ffc3a0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #ff4d8d;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .btn {
            background: #ff4d8d;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px 5px;
        }
        
        .btn:hover {
            background: #e63e7b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary {
            background: #9d4edd;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .photo-upload-area {
            border: 3px dashed #ffc3a0;
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s;
        }
        
        .photo-upload-area:hover {
            border-color: #ff4d8d;
            background: #fff0f6;
        }
        
        .photo-upload-area i {
            font-size: 3rem;
            color: #ff4d8d;
            margin-bottom: 15px;
        }
        
        .preview-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .photo-preview {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            height: 150px;
        }
        
        .photo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .remove-photo {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
        }
        
        .qr-container {
            text-align: center;
            padding: 30px;
            background: #fff0f6;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .qr-code {
            width: 250px;
            height: 250px;
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 15px;
            border: 3px solid #ffc3a0;
        }
        
        .qr-code img {
            width: 100%;
            height: 100%;
        }
        
        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .memory-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #ff4d8d;
        }
        
        .memory-date {
            color: #9d4edd;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            height: 10px;
            background: #ffc3a0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: #ff4d8d;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .instructions {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #9d4edd;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ffc3a0;
            color: #9d4edd;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .share-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-heart"></i> Cr√©ateur de Souvenirs</h1>
            <p class="subtitle">Cr√©ez une surprise romantique pour votre partenaire</p>
            
            <div class="step-indicator">
                <div class="step active" id="step1">1</div>
                <div class="step" id="step2">2</div>
                <div class="step" id="step3">3</div>
                <div class="step" id="step4">4</div>
            </div>
            
            <div class="progress-bar">
                <div class="progress" id="progressBar" style="width: 25%;"></div>
            </div>
        </header>
        
        <!-- √âtape 1 : Informations -->
        <section id="step1-section" class="section active">
            <h2><i class="fas fa-user"></i> Informations Personnelles</h2>
            <p class="instructions">Commencez par remplir ces informations pour personnaliser votre cr√©ation.</p>
            
            <div class="form-group">
                <label for="partnerName">Nom de votre partenaire :</label>
                <input type="text" id="partnerName" placeholder="Ex: Marie, Jean, etc.">
            </div>
            
            <div class="form-group">
                <label for="yourName">Votre nom :</label>
                <input type="text" id="yourName" placeholder="Comment votre partenaire vous appelle">
            </div>
            
            <div class="form-group">
                <label for="anniversary">Date de votre rencontre / anniversaire :</label>
                <input type="date" id="anniversary">
            </div>
            
            <div class="form-group">
                <label for="loveMessage">Message d'amour principal :</label>
                <textarea id="loveMessage" placeholder="√âcrivez un message d'amour touchant pour votre partenaire...">Ma ch√©rie, chaque jour avec toi est un cadeau. En cette Saint-Valentin, je voulais te cr√©er quelque chose de sp√©cial pour te montrer √† quel point tu comptes pour moi.</textarea>
            </div>
            
            <div style="text-align: right;">
                <button class="btn" onclick="nextStep(2)">
                    Suivant <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </section>
        
        <!-- √âtape 2 : Souvenirs -->
        <section id="step2-section" class="section">
            <h2><i class="fas fa-memory"></i> Ajoutez vos Souvenirs</h2>
            <p class="instructions">Ajoutez les moments sp√©ciaux que vous avez partag√©s ensemble.</p>
            
            <div class="form-group">
                <label for="memoryTitle">Titre du souvenir :</label>
                <input type="text" id="memoryTitle" placeholder="Ex: Notre premier rendez-vous">
            </div>
            
            <div class="form-group">
                <label for="memoryDate">Date du souvenir :</label>
                <input type="date" id="memoryDate">
            </div>
            
            <div class="form-group">
                <label for="memoryDescription">Description :</label>
                <textarea id="memoryDescription" placeholder="D√©crivez ce moment sp√©cial..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="memoryEmotion">√âmotion principale :</label>
                <select id="memoryEmotion">
                    <option value="‚ù§Ô∏è Amour">‚ù§Ô∏è Amour</option>
                    <option value="üòÇ Rire">üòÇ Rire</option>
                    <option value="üòä Bonheur">üòä Bonheur</option>
                    <option value="ü§ó Tendresse">ü§ó Tendresse</option>
                    <option value="ü§© √âmerveillement">ü§© √âmerveillement</option>
                </select>
            </div>
            
            <div style="display: flex; gap: 10px; margin: 20px 0;">
                <button class="btn" onclick="addMemory()">
                    <i class="fas fa-plus"></i> Ajouter ce souvenir
                </button>
                <button class="btn btn-secondary" onclick="nextStep(3)">
                    Passer aux photos <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            
            <h3>Souvenirs ajout√©s :</h3>
            <div id="memoriesList">
                <!-- Les souvenirs seront ajout√©s ici -->
            </div>
        </section>
        
        <!-- √âtape 3 : Photos -->
        <section id="step3-section" class="section">
            <h2><i class="fas fa-images"></i> Ajoutez vos Photos</h2>
            <p class="instructions">T√©l√©chargez des photos de vos moments ensemble (max 6 photos).</p>
            
            <div class="photo-upload-area" onclick="document.getElementById('photoInput').click()">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Cliquez pour ajouter des photos</h3>
                <p>ou glissez-d√©posez vos images ici</p>
                <p style="font-size: 0.9rem; color: #666;">Formats accept√©s: JPG, PNG, GIF (max 5MB)</p>
            </div>
            
            <input type="file" id="photoInput" accept="image/*" multiple style="display: none;" onchange="handlePhotoUpload(event)">
            
            <div class="preview-gallery" id="photoGallery">
                <!-- Les pr√©visualisations de photos appara√Ætront ici -->
            </div>
            
            <div style="text-align: right; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="prevStep(2)">
                    <i class="fas fa-arrow-left"></i> Retour aux souvenirs
                </button>
                <button class="btn" onclick="nextStep(4)">
                    G√©n√©rer le QR Code <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </section>
        
        <!-- √âtape 4 : QR Code -->
        <section id="step4-section" class="section">
            <h2><i class="fas fa-qrcode"></i> Votre QR Code Personnalis√©</h2>
            <p class="instructions">Partagez ce QR Code avec votre partenaire. En le scannant, il/elle pourra voir tous vos souvenirs et messages.</p>
            
            <div class="qr-container">
                <h3>Votre cr√©ation est pr√™te !</h3>
                <p>Scannez ce code avec un smartphone pour voir votre cr√©ation</p>
                
                <div class="qr-code" id="qrCodeContainer">
                    <!-- QR Code g√©n√©r√© dynamiquement -->
                </div>
                
                <div class="share-buttons">
                    <button class="btn" onclick="downloadQRCode()">
                        <i class="fas fa-download"></i> T√©l√©charger QR Code
                    </button>
                    <button class="btn btn-success" onclick="shareViaWhatsApp()">
                        <i class="fab fa-whatsapp"></i> Partager sur WhatsApp
                    </button>
                    <button class="btn" style="background: #7289da;" onclick="copyLink()">
                        <i class="fas fa-link"></i> Copier le lien
                    </button>
                </div>
                
                <div id="generatedUrl" style="margin: 20px 0; padding: 10px; background: white; border-radius: 10px; word-break: break-all; font-family: monospace;"></div>
                
                <div class="instructions">
                    <h4><i class="fas fa-mobile-alt"></i> Comment partager :</h4>
                    <ol style="text-align: left;">
                        <li>T√©l√©chargez le QR Code</li>
                        <li>Envoyez-le √† votre partenaire par message</li>
                        <li>Votre partenaire le scanne avec son t√©l√©phone</li>
                        <li>Il/elle verra tous vos souvenirs et messages !</li>
                    </ol>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="prevStep(3)">
                    <i class="fas fa-arrow-left"></i> Modifier les photos
                </button>
                <button class="btn" onclick="regenerateQR()">
                    <i class="fas fa-sync-alt"></i> R√©g√©n√©rer QR Code
                </button>
            </div>
        </section>
        
        <footer>
            <p>Cr√©√© avec ‚ù§Ô∏è pour la Saint-Valentin</p>
            <p style="font-size: 0.9rem; margin-top: 10px;">Votre partenaire sera √©mu(e) par cette attention !</p>
        </footer>
    </div>

    <script>
        // Donn√©es de l'application
        let appData = {
            partnerName: '',
            yourName: '',
            anniversary: '',
            loveMessage: '',
            memories: [],
            photos: []
        };
        
        let currentStep = 1;
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            updateStepIndicator();
            
            // Charger les donn√©es sauvegard√©es
            const savedData = localStorage.getItem('valentineCreatorData');
            if (savedData) {
                appData = JSON.parse(savedData);
                loadSavedData();
            }
        });
        
        // Navigation entre √©tapes
        function nextStep(step) {
            // Sauvegarder les donn√©es de l'√©tape actuelle
            saveCurrentStepData();
            
            // Masquer l'√©tape actuelle
            document.getElementById(`step${currentStep}-section`).classList.remove('active');
            document.getElementById(`step${currentStep}`).classList.remove('active');
            
            // Afficher la nouvelle √©tape
            currentStep = step;
            document.getElementById(`step${currentStep}-section`).classList.add('active');
            document.getElementById(`step${currentStep}`).classList.add('active');
            
            // Mettre √† jour l'indicateur de progression
            updateStepIndicator();
            
            // Si on arrive √† l'√©tape 4, g√©n√©rer le QR Code
            if (step === 4) {
                generateQRCode();
            }
        }
        
        function prevStep(step) {
            nextStep(step);
        }
        
        function updateStepIndicator() {
            const steps = document.querySelectorAll('.step');
            const progress = (currentStep / 4) * 100;
            
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            steps.forEach((step, index) => {
                const stepNum = index + 1;
                if (stepNum < currentStep) {
                    step.classList.add('completed');
                    step.classList.remove('active');
                } else if (stepNum === currentStep) {
                    step.classList.add('active');
                    step.classList.remove('completed');
                } else {
                    step.classList.remove('active', 'completed');
                }
            });
        }
        
        // Sauvegarder les donn√©es de l'√©tape actuelle
        function saveCurrentStepData() {
            switch(currentStep) {
                case 1:
                    appData.partnerName = document.getElementById('partnerName').value;
                    appData.yourName = document.getElementById('yourName').value;
                    appData.anniversary = document.getElementById('anniversary').value;
                    appData.loveMessage = document.getElementById('loveMessage').value;
                    break;
                case 2:
                    // Les souvenirs sont ajout√©s via addMemory()
                    break;
                case 3:
                    // Les photos sont g√©r√©es via handlePhotoUpload()
                    break;
            }
            
            // Sauvegarder dans le localStorage
            localStorage.setItem('valentineCreatorData', JSON.stringify(appData));
        }
        
        // Charger les donn√©es sauvegard√©es
        function loadSavedData() {
            document.getElementById('partnerName').value = appData.partnerName || '';
            document.getElementById('yourName').value = appData.yourName || '';
            document.getElementById('anniversary').value = appData.anniversary || '';
            document.getElementById('loveMessage').value = appData.loveMessage || '';
            
            // Charger les souvenirs
            if (appData.memories && appData.memories.length > 0) {
                appData.memories.forEach(memory => {
                    addMemoryToUI(memory);
                });
            }
        }
        
        // Gestion des souvenirs
        function addMemory() {
            const title = document.getElementById('memoryTitle').value.trim();
            const date = document.getElementById('memoryDate').value;
            const description = document.getElementById('memoryDescription').value.trim();
            const emotion = document.getElementById('memoryEmotion').value;
            
            if (!title || !description) {
                alert('Veuillez remplir au moins le titre et la description du souvenir.');
                return;
            }
            
            const memory = {
                id: Date.now(),
                title,
                date: date || new Date().toISOString().split('T')[0],
                description,
                emotion
            };
            
            appData.memories.push(memory);
            addMemoryToUI(memory);
            
            // R√©initialiser les champs
            document.getElementById('memoryTitle').value = '';
            document.getElementById('memoryDate').value = '';
            document.getElementById('memoryDescription').value = '';
            
            localStorage.setItem('valentineCreatorData', JSON.stringify(appData));
        }
        
        function addMemoryToUI(memory) {
            const memoriesList = document.getElementById('memoriesList');
            
            const memoryCard = document.createElement('div');
            memoryCard.className = 'memory-card';
            memoryCard.innerHTML = `
                <div class="memory-date">
                    <strong>${memory.emotion}</strong> ‚Ä¢ ${new Date(memory.date).toLocaleDateString('fr-FR')}
                </div>
                <h4>${memory.title}</h4>
                <p>${memory.description}</p>
                <button onclick="removeMemory(${memory.id})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            `;
            
            memoriesList.appendChild(memoryCard);
        }
        
        function removeMemory(id) {
            appData.memories = appData.memories.filter(memory => memory.id !== id);
            localStorage.setItem('valentineCreatorData', JSON.stringify(appData));
            
            // Recharger l'interface
            document.getElementById('memoriesList').innerHTML = '';
            appData.memories.forEach(memory => addMemoryToUI(memory));
        }
        
        // Gestion des photos
        function handlePhotoUpload(event) {
            const files = event.target.files;
            const photoGallery = document.getElementById('photoGallery');
            
            for (let i = 0; i < Math.min(files.length, 6 - appData.photos.length); i++) {
                const file = files[i];
                
                if (file.size > 5 * 1024 * 1024) {
                    alert(`La photo ${file.name} d√©passe la taille maximale de 5MB`);
                    continue;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoData = {
                        id: Date.now() + i,
                        name: file.name,
                        dataUrl: e.target.result
                    };
                    
                    appData.photos.push(photoData);
                    addPhotoToUI(photoData);
                    
                    if (i === Math.min(files.length, 6 - appData.photos.length) - 1) {
                        localStorage.setItem('valentineCreatorData', JSON.stringify(appData));
                    }
                };
                reader.readAsDataURL(file);
            }
            
            // R√©initialiser l'input
            event.target.value = '';
        }
        
        function addPhotoToUI(photo) {
            const photoGallery = document.getElementById('photoGallery');
            
            const photoContainer = document.createElement('div');
            photoContainer.className = 'photo-preview';
            photoContainer.innerHTML = `
                <img src="${photo.dataUrl}" alt="${photo.name}">
                <button class="remove-photo" onclick="removePhoto(${photo.id})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            photoGallery.appendChild(photoContainer);
        }
        
        function removePhoto(id) {
            appData.photos = appData.photos.filter(photo => photo.id !== id);
            localStorage.setItem('valentineCreatorData', JSON.stringify(appData));
            
            // Recharger l'interface
            document.getElementById('photoGallery').innerHTML = '';
            appData.photos.forEach(photo => addPhotoToUI(photo));
        }
        
        // G√©n√©ration du QR Code
        function generateQRCode() {
            // Cr√©er un identifiant unique pour cette cr√©ation
            const creationId = 'valentine-' + Date.now();
            
            // Sauvegarder la cr√©ation compl√®te
            const creationData = {
                id: creationId,
                timestamp: new Date().toISOString(),
                data: appData
            };
            
            localStorage.setItem(creationId, JSON.stringify(creationData));
            
            // G√©n√©rer une URL pour acc√©der √† la cr√©ation
            const viewerUrl = `${window.location.origin}${window.location.pathname}?view=${creationId}`;
            
            // Afficher l'URL
            document.getElementById('generatedUrl').textContent = viewerUrl;
            
            // G√©n√©rer le QR Code
            const qrContainer = document.getElementById('qrCodeContainer');
            qrContainer.innerHTML = '';
            
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(viewerUrl)}&color=ff4d8d&bgcolor=fff0f6&qzone=2`;
            
            const img = document.createElement('img');
            img.src = qrUrl;
            img.alt = 'QR Code pour votre cr√©ation romantique';
            qrContainer.appendChild(img);
            
            // Sauvegarder l'URL dans le localStorage pour y acc√©der plus tard
            localStorage.setItem('lastCreationUrl', viewerUrl);
        }
        
        function regenerateQR() {
            generateQRCode();
            alert('QR Code r√©g√©n√©r√© avec succ√®s !');
        }
        
        // Fonctions de partage
        function downloadQRCode() {
            const qrUrl = document.querySelector('#qrCodeContainer img').src;
            const link = document.createElement('a');
            link.href = qrUrl;
            link.download = 'mon-cadeau-saint-valentin.png';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('QR Code t√©l√©charg√© ! Envoyez-le √† votre partenaire.');
        }
        
        function shareViaWhatsApp() {
            const viewerUrl = document.getElementById('generatedUrl').textContent;
            const message = `‚ù§Ô∏è J'ai cr√©√© une surprise pour toi pour la Saint-Valentin !\n\nScanne ce QR Code ou ouvre ce lien :\n${viewerUrl}\n\nJe t'aime !`;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }
        
        function copyLink() {
            const viewerUrl = document.getElementById('generatedUrl').textContent;
            navigator.clipboard.writeText(viewerUrl).then(() => {
                alert('Lien copi√© dans le presse-papier ! Partagez-le avec votre partenaire.');
            });
        }
        
        // V√©rifier si on doit afficher une cr√©ation
        function checkForViewerMode() {
            const urlParams = new URLSearchParams(window.location.search);
            const viewId = urlParams.get('view');
            
            if (viewId) {
                // Afficher la cr√©ation
                const creationData = localStorage.getItem(viewId);
                if (creationData) {
                    displayCreation(JSON.parse(creationData));
                }
            }
        }
        
        function displayCreation(creationData) {
            // Cette fonction affiche la cr√©ation pour le partenaire
            // Pour l'instant, afficher simplement un message
            alert(`Mode visualisation activ√© pour la cr√©ation de ${creationData.data.yourName} !`);
            
            // Vous pouvez d√©velopper cette fonction pour afficher
            // une belle interface de visualisation
        }
        
        // V√©rifier au chargement
        checkForViewerMode();
    </script>
</body>
</html>

